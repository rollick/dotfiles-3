#!/bin/sh
# Setup environment for X sessions

# Use XDG dirs
if [[ -f "${XDG_CONFIG_HOME:-${HOME}/.config}/user-dirs.dirs" ]]; then
	source "${XDG_CONFIG_HOME:-${HOME}/.config}/user-dirs.dirs"
	[[ -n $XDG_DESKTOP_DIR ]] && export XDG_DESKTOP_DIR
	[[ -n $XDG_DOWNLOAD_DIR ]] && export XDG_DOWNLOAD_DIR
	[[ -n $XDG_TEMPLATES_DIR ]] && export XDG_TEMPLATES_DIR
	[[ -n $XDG_DOCUMENTS_DIR ]] && export XDG_DOCUMENTS_DIR
	[[ -n $XDG_MUSIC_DIR ]] && export XDG_MUSIC_DIR
	[[ -n $XDG_PICTURES_DIR ]] && export XDG_PICTURES_DIR
	[[ -n $XDG_VIDEOS_DIR ]] && export XDG_VIDEOS_DIR
fi

export GIMP2_DIRECTORY="${XDG_CONFIG_HOME:-${HOME}/.config}/gimp2"
export GTK2_RC_FILES="${XDG_CONFIG_HOME:-${HOME}/.config}/gtk-2.0/gtkrc-2.0"

# Remove missing accessibility bus messages
export NO_AT_BRIDGE=1

# Set terminal for i3
export RXVT_SOCKET="${XDG_RUNTIME_DIR:-/run/user/${UID}}/urxvtd"

if which urxvtcd >/dev/null 2>&1; then
	export TERMINAL='urxvtcd'
else
	export TERMINAL='urxvt'
fi
export TERMCMD="${TERMINAL}"

# Set correct driver for libva
export LIBVA_DRIVER_NAME='vdpau'
export VDPAU_DRIVER="nouveau"

# Use GTK2+ in Libre Office
export SAL_USE_VCLPLUGIN='gtk'

# Disable GTK3+ overlay scrollbars
export GTK_OVERLAY_SCROLLING=0

# Always use the light GTK3+ theme
if [[ -f "${XDG_CONFIG_HOME:-${HOME}/.config}/gtk-3.0/settings.ini" ]]; then
	GTK_THEME="$(grep gtk-theme-name ${XDG_CONFIG_HOME:-${HOME}/.config}/gtk-3.0/settings.ini)"
	export GTK_THEME="$(echo ${GTK_THEME##*=} |tr -d '[[:space:]]'):light"
fi

# Fix some issues if no DE is used
if [[ -z ${DESKTOP_SESSION} ]]; then
	export DESKTOP_SESSION='gnome'
	export GNOME_DESKTOP_SESSION=1
fi
