##############################
# Autostart
##############################
exec --no-startup-id sh ~/.fehbg
exec --no-startup-id xcompmgr
exec --no-startup-id thunar --daemon
# i3status needs to be updated or i3bar will hang
exec --no-startup-id sleep 2 && killall -USR1 i3status

##############################
# Appearance
##############################
set $focused_bg #1a80b6
set $focused_fg #f9f9f9
set $unfocused_bg #2d2d2d
set $unfocused_fg #dcdcdc
set $urgent_bg #d64937
set $urgent_fg #2d2d2d
set $separator_fg #888888
set $indicator_off #2d2d2d
set $indicator_on #2d2d2d

# Set font
font pango:Droid Sans Bold 10

# Set colors for window decorations
# class                 border        background    foreground indicator
client.focused          $focused_bg   $focused_bg   $focused_fg   $indicator_on
client.focused_inactive $unfocused_bg $unfocused_bg $unfocused_fg $indicator_off
client.unfocused        $unfocused_bg $unfocused_bg $unfocused_fg $indicator_off
client.urgent           $urgent_bg    $urgent_bg    $urgent_fg    $urgent_bg

# i3bar
bar {
	status_command i3status
	font pango:Droid Sans 10
	position top
	separator_symbol "|"
	colors {
		background $unfocused_bg
		statusline $unfocused_fg
		separator $separator_fg
		# class            border        background    foreground    indicator
		focused_workspace  $focused_bg   $focused_bg   $focused_fg   $unfocused_bg
		active_workspace   $separator_fg $separator_fg $unfocused_fg $focused_bg
		inactive_workspace $unfocused_bg $unfocused_bg $unfocused_fg $focused_bg
		urgent_workspace   $urgent_bg    $urgent_bg    $unfocused_fg $focused_bg
	}
}

##############################
# General settings
##############################
workspace_auto_back_and_forth yes

##############################
# Window rules
##############################
for_window [class="Firefox" window_role="^(?!browser$)"] floating enable
for_window [class="Firefox" title="^ProfileSwitcher$"] floating enable
for_window [class="Glade" title="^Edit .*"] floating enable
for_window [class="Glade-previewer"] floating enable
for_window [class="MP3Diags" title="^MP3 Diags$"] floating disable
for_window [class="Xsane"] floating enable
for_window [title="^Task Manager - Chromium$"] floating enable

##############################
# Keybindings
##############################
# $mod -- Perform action on parent
# $mod+Shift -- Perform action on a window/container
# $mod+Ctrl -- Run command

# Set modifier
set $mod Mod4
floating_modifier $mod

# Modes
mode "resize" {
	bindsym Left resize shrink width 10 px or 10 ppt
	bindsym Right resize grow width 10 px or 10 ppt
	bindsym Up resize grow height 10 px or 10 ppt
	bindsym Down resize shrink height 10 px or 10 ppt

	bindsym Escape mode "default"
	bindsym Return mode "default"
}

mode "run" {
	bindsym b exec exo-open --launch WebBrowser; mode "default"
	bindsym f exec exo-open --launch FileManager; mode "default"
	bindsym m exec cmus_gui
	bindsym t exec i3-sensible-terminal; mode "default"

	bindsym Escape mode "default"
	bindsym Return mode "default"
}

mode "session-control" {
	bindsym c reload; mode "default"
	bindsym e exit; mode "default"
	bindsym r restart; mode "default"

	bindsym Escape mode "default"
	bindsym Return mode "default"
}

# Change focus
bindsym $mod+Left focus left
bindsym $mod+Right focus right
bindsym $mod+Up focus up
bindsym $mod+Down focus down

# Move container
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Right move right
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Down move down

# Focus container
bindsym $mod+c focus child
bindsym $mod+p focus parent

# Split in (h)orizontal or (v)ertical orientation
bindsym $mod+h split h
bindsym $mod+v split v

# Kill currently focused container
bindsym $mod+Shift+q kill

# Enter fullscreen mode for the focused container
bindsym $mod+Shift+f fullscreen toggle

# Resize container
bindsym $mod+Shift+r mode resize

# Floating container
bindsym $mod+space focus mode_toggle
bindsym $mod+Shift+space floating toggle

# Switch to workspace
bindsym $mod+Tab workspace back_and_forth
bindsym $mod+0 scratchpad show
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9

bindsym $mod+KP_Add workspace back_and_forth
bindsym $mod+KP_0 scratchpad show
bindsym $mod+KP_1 workspace 1
bindsym $mod+KP_2 workspace 2
bindsym $mod+KP_3 workspace 3
bindsym $mod+KP_4 workspace 4
bindsym $mod+KP_5 workspace 5
bindsym $mod+KP_6 workspace 6
bindsym $mod+KP_7 workspace 7
bindsym $mod+KP_8 workspace 8
bindsym $mod+KP_9 workspace 9

# Move container to workspace
bindsym $mod+Shift+Tab move container to workspace back_and_forth
bindsym $mod+Shift+0 move scratchpad
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9

bindsym $mod+Shift+KP_Add move container to workspace back_and_forth
bindsym $mod+Shift+KP_0 move scratchpad
bindsym $mod+Shift+KP_1 move container to workspace 1
bindsym $mod+Shift+KP_2 move container to workspace 2
bindsym $mod+Shift+KP_3 move container to workspace 3
bindsym $mod+Shift+KP_4 move container to workspace 4
bindsym $mod+Shift+KP_5 move container to workspace 5
bindsym $mod+Shift+KP_6 move container to workspace 6
bindsym $mod+Shift+KP_7 move container to workspace 7
bindsym $mod+Shift+KP_8 move container to workspace 8
bindsym $mod+Shift+KP_9 move container to workspace 9

# Start applications
bindsym XF86AudioLowerVolume exec --no-startup-id amixer --quiet sset Master 5%- unmute && killall -USR1 i3status
bindsym XF86AudioMute exec --no-startup-id amixer --quiet sset Master toggle && killall -USR1 i3status
bindsym XF86AudioPlay exec --no-startup-id cmus-remote --pause
bindsym XF86AudioRaiseVolume exec --no-startup-id amixer --quiet sset Master 5%+ unmute && killall -USR1 i3status
bindsym XF86Calculator exec i3-sensible-terminal -t Calculator -e python
bindsym XF86HomePage exec exo-open --launch WebBrowser
bindsym XF86Mail exec exo-open --launch WebBrowser https://www.gmail.com/
bindsym $mod+Ctrl+Return exec i3-sensible-terminal

# Session control
bindsym XF86Sleep exec --no-startup-id i3-exit --dmenu="rofi -dmenu"
bindsym $mod+Ctrl+b mode "session-control"
bindsym $mod+Ctrl+e mode "run"
bindsym $mod+Ctrl+d exec --no-startup-id rofi -show run -p "Run:"
bindsym $mod+Ctrl+l exec --no-startup-id i3lock --color=2d2d2d
bindsym $mod+Ctrl+s exec --no-startup-id i3-exit --dmenu="rofi -dmenu"
